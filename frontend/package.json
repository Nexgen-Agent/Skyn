// src/views/PackageAura.jsx
import React, { useEffect, useRef, useState } from "react";

// Particle background
function AuraParticles() {
  const ref = useRef();
  useEffect(() => {
    const canvas = ref.current;
    const ctx = canvas.getContext("2d");
    let width = window.innerWidth, height = window.innerHeight;
    let particles = [];
    function resize() {
      width = window.innerWidth;
      height = window.innerHeight;
      canvas.width = width;
      canvas.height = height;
    }
    window.addEventListener("resize", resize);
    resize();
    for (let i = 0; i < 38; i++) {
      particles.push({
        x: Math.random() * width,
        y: Math.random() * height,
        r: 1.2 + Math.random() * 2.2,
        dx: -0.45 + Math.random() * 0.9,
        dy: -0.45 + Math.random() * 0.9,
        hue: 32 + Math.random() * 94
      });
    }
    function animate() {
      ctx.clearRect(0, 0, width, height);
      for (const p of particles) {
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r, 0, 2 * Math.PI);
        ctx.fillStyle = `hsla(${p.hue}, 96%, 65%, 0.27)`;
        ctx.shadowColor = `hsla(${p.hue}, 99%, 80%, 0.44)`;
        ctx.shadowBlur = 14;
        ctx.fill();
        ctx.closePath();
        p.x += p.dx;
        p.y += p.dy;
        if (p.x < 0 || p.x > width) p.dx *= -1;
        if (p.y < 0 || p.y > height) p.dy *= -1;
      }
      requestAnimationFrame(animate);
    }
    animate();
    return () => window.removeEventListener("resize", resize);
  }, []);
  return (
    <canvas
      ref={ref}
      style={{
        position: "fixed",
        zIndex: 0,
        top: 0,
        left: 0,
        width: "100vw",
        height: "100vh",
        opacity: 0.32,
        pointerEvents: "none"
      }}
    />
  );
}

export default function PackageAura() {
  const [json, setJson] = useState(null);

  useEffect(() => {
    fetch(
      "https://raw.githubusercontent.com/Nexgen-Agent/Skyn/main/frontend/package.json"
    )
      .then((res) => res.text())
      .then((txt) => setJson(txt));
  }, []);

  return (
    <div
      style={{
        minHeight: "100vh",
        background: "linear-gradient(120deg,#0f2027 0%,#2c5364 65%,#ffecd2 100%)",
        fontFamily: "'Poppins','Segoe UI',Arial,sans-serif",
        display: "flex",
        alignItems: "center",
        justifyContent: "center",
        position: "relative",
        overflow: "hidden"
      }}
    >
      <AuraParticles />
      {/* Animated Aura Gradient Overlay */}
      <div
        style={{
          position: "fixed",
          top: 0,
          left: 0,
          width: "100vw",
          height: "100vh",
          pointerEvents: "none",
          zIndex: 1,
          mixBlendMode: "lighten",
          background:
            "radial-gradient(ellipse at 30% 30%, #78ffd6 0%, transparent 60%)," +
            "radial-gradient(ellipse at 70% 60%, #a8ff78 0%, transparent 70%)," +
            "radial-gradient(circle at 80% 10%, #f5576c 0%, transparent 70%)",
          opacity: 0.55,
          animation: "auraGradientMove 14s linear infinite alternate"
        }}
      />
      <style>
        {`
          @keyframes auraGradientMove {
            0%{ background-position: 0% 0%, 100% 100%, 100% 0%; }
            100%{ background-position: 100% 100%, 0% 0%, 0% 100%; }
          }
          .aura-glass {
            background: rgba(255,255,255,0.16);
            border-radius: 2.4rem;
            box-shadow: 0 12px 40px 0 rgba(31,38,135,0.22), 0 0 60px #ffd20055;
            border: 1.6px solid rgba(255,255,255,0.20);
            backdrop-filter: blur(16px) saturate(145%);
            -webkit-backdrop-filter: blur(16px) saturate(145%);
            transition: box-shadow 0.8s, background 0.7s;
          }
          .aura-glass:hover {
            box-shadow: 0 24px 72px #ffd20055, 0 4px 90px #f7971e22;
            background: rgba(255,255,255,0.23);
          }
          .aura-title {
            color: #ffd200;
            font-size: 2.3rem;
            font-weight: 900;
            letter-spacing: 0.04em;
            margin-bottom: 1.1rem;
            text-align: center;
            filter: drop-shadow(0 2px 32px #ffd20055);
          }
          .aura-filename {
            color: #f7971e;
            font-size: 1.12rem;
            font-weight: 700;
            letter-spacing: 0.018em;
            text-align: center;
            margin-bottom: 1.7rem;
            background: linear-gradient(90deg, #ffd200 0%, #f7971e 80%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
          }
          .aura-code {
            background: rgba(255,255,255,0.13);
            font-family: 'Fira Mono', 'Consolas', monospace;
            font-size: 1.03rem;
            color: #222;
            padding: 1.35rem 1.8rem;
            border-radius: 1.3rem;
            box-shadow: 0 2px 16px #ffd20022;
            overflow-x: auto;
            max-height: 60vh;
            line-height: 1.58;
            letter-spacing: 0.01em;
            transition: background 0.5s;
            margin-bottom: 0.8rem;
            animation: auraFadeIn 1.2s;
          }
          @keyframes auraFadeIn {
            0% { filter: blur(18px) opacity(0); }
            100% { filter: blur(0) opacity(1); }
          }
          .aura-logo-art {
            width: 88px; height: 88px; margin: 0 auto 1.4rem auto;
            border-radius: 50%;
            background: linear-gradient(135deg, #f7971e 0%, #ffd200 100%);
            box-shadow: 0 0 44px #ffd20055, 0 0 90px #f7971e22;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: auraPulse 3s infinite alternate;
          }
          @keyframes auraPulse {
            0% { box-shadow: 0 0 44px #ffd20055, 0 0 90px #f7971e22; }
            100% { box-shadow: 0 0 72px #ffd200cc, 0 0 140px #f7971e33; }
          }
        `}
      </style>
      <div
        className="aura-glass"
        style={{
          maxWidth: "700px",
          width: "97vw",
          zIndex: 2,
          padding: "2.3rem 2rem 2rem 2rem",
          boxSizing: "border-box"
        }}
      >
        <div className="aura-logo-art">
          <svg viewBox="0 0 60 60" fill="none" style={{width: 52, height: 52}}>
            <circle cx="30" cy="30" r="22" fill="#fffbe9" opacity="0.93"/>
            <ellipse cx="30" cy="36" rx="13" ry="7" fill="#ffe3a3" opacity="0.7"/>
            <ellipse cx="25" cy="27" rx="2" ry="2.3" fill="#f7971e" />
            <ellipse cx="35" cy="27" rx="2" ry="2.3" fill="#f7971e" />
            <path d="M24 38 Q30 43 36 38" stroke="#f7971e" strokeWidth="2.2" strokeLinecap="round" fill="none"/>
            <g stroke="#ffd200" strokeWidth="2">
              <line x1="30" y1="7" x2="30" y2="0"/>
              <line x1="30" y1="53" x2="30" y2="60"/>
              <line x1="7" y1="30" x2="0" y2="30"/>
              <line x1="53" y1="30" x2="60" y2="30"/>
              <line x1="14" y1="14" x2="5" y2="5"/>
              <line x1="46" y1="14" x2="55" y2="5"/>
              <line x1="14" y1="46" x2="5" y2="55"/>
              <line x1="46" y1="46" x2="55" y2="55"/>
            </g>
          </svg>
        </div>
        <div className="aura-title">Lonz Flawls Auraâ„¢ package.json</div>
        <div className="aura-filename">frontend/package.json</div>
        <pre className="aura-code">
          {json ? json : "Loading..."}
        </pre>
      </div>
    </div>
  );
}
